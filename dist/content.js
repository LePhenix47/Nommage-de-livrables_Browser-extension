(()=>{"use strict";function e(e,t=document){if(t===document)return document.querySelector(e);switch(!0){case t.tagName?.includes("-"):return t.shadowRoot?.querySelector(e);case t instanceof HTMLTemplateElement:return document.importNode(t.content,!0).querySelector(e);case t instanceof HTMLIFrameElement:return t.contentDocument?.querySelector(e);default:return t.querySelector(e)}}function t(e,t=document){if(t===document)return Array.from(document.querySelectorAll(e));switch(!0){case t.tagName?.includes("-"):return Array.from(t.shadowRoot?.querySelectorAll(e)||[]);case t instanceof HTMLTemplateElement:return Array.from(document.importNode(t.content,!0).querySelectorAll(e));case t instanceof HTMLIFrameElement:return Array.from(t.contentDocument?.querySelectorAll(e)||[]);default:return Array.from(t.querySelectorAll(e))}}const n=["ndl_firstName","ndl_lastName","ndl_date"];async function o(){const o=function(){const n=t('aside[data-claire-semantic="information"]').find((e=>{if(e.innerText.includes("Dupont_Jean"))return e}));if(!n)throw new Error("Aside not found");const o=e("p>strong",n),r=e("ul",n),c=t("li",r);if(!r||!c)throw new Error("Child elements to be updated (<ul> or array of <li>s) not found");const l=new Map;return l.set("title",[o]),l.set("list-items",c),l}(),r=await async function(){const e=new Map;for(const t of n){const n=t.split("_")[1],o=await chrome.storage.sync.get(t);if(!o)throw new Error(`${n} does not exist on local storage`);switch(n){case"date":{const t=new Date(o?.ndl_date).toLocaleString("fr-FR",{year:"numeric",month:"2-digit"}).replaceAll("/","");e.set(n,t);break}default:e.set(n,o[t])}}return e}();console.log(r);const c=`${r.get("lastName")}_${r.get("firstName")}`,l=`${function(){const t=e("h1");if(!t)throw new Error("No h1 element found");return t.innerText.replaceAll(" ","_")}()}_${c}`,a=document.createElement("em"),i=o.get("title")[0];a.textContent=l,i.innerHTML="",i.appendChild(a);const s=o.get("list-items"),d=r.get("date");for(const e of s){const t=document.createElement("em"),n=e.innerText.replaceAll("Nom_PrÃ©nom",c).replaceAll("mmaaaa",d);e.innerHTML="",t.textContent=n,e.appendChild(t)}}!function(){let e=0;!function t(n){if(e>=15)return void console.log("%cMax call stack exceeded (15 calls MAX), the script will stop to avoid infinite loops, please reload the page to restart the script","padding:5px; font-size: 16px; background-color: red; color:white;");setTimeout((async()=>{try{return await o(),void console.log("%cThe script worked!","padding:5px; font-size: 16px; background: green; color:white;")}catch(n){console.log(`%c${n}`,"padding:5px; font-size: 16px; background-color: darkred; color:white;"),e++,t(500)}}),n)}(3e3),console.log("%cThe script started!","padding:5px; font-size: 16px; background: darkblue; color:white;")}(),console.log("Hello content.ts")})();